<%- include('partials/headerNavbar.ejs') %>
<div class='p-3 mb-5'>
  <div class='container pt-3 pb-2 bg-white rounded-3'>
    <div class='mx-3'>
      <h1>TRANSACTION</h1>
      <hr>
    </div>
    <!-- <form action='/user/history' method="post"> -->
    <div class='container'>
      <div class='container my-3 py-3 px-4 bg-address shadow-sm' style='border-radius: 15px;'>
        <div class='container mb-3'>
            <h3>Delivery Information</h3>
        </div>
        <div class="container">
              <div class='row col-12 mb-3'>
                  <div class="col-xxl-4 col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12">
                      <label class="form-label">Fullname</label>
                      <input type="text" class="form-control" name="fullname" placeholder="Firstname&#x09;Lastname" value='<%= user.fullname%>' required>
                  </div>
                  <div class="col-xxl-4 col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12">
                      <label class="form-label">Phone number</label>
                      <input type="text" class="form-control" name="phone" placeholder="Phone number" value='<%= user.phone%>' required>
                  </div>
                  <div class="col-xxl-4 col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12">
                      <label class="form-label">Email</label>
                      <input type="text" class="form-control" name="email" placeholder="Email" value='<%= user.email%>' required>
                  </div>
              </div>
              <div class='row col-12 mb-3'>
                  <div class="col-12">
                      <label class="form-label">Address</label>
                      <input type="text" class="form-control" name="address" placeholder="Address" value='<%= user.address%>' required>
                  </div>
              </div>
        </div>
      </div>
    </div>
    <div class='mx-3'>
      <hr>
    </div>
    <div class='container row mx-auto mt-3 justify-content-between'>
      <div class='col-xxl-9 col-xl-9 col-lg-12 col-md-12 col-sm-12 col-12'>
        <div class='row col-12 text-transaction-hide'>
          <div class='col-6'>
            <h4>Product name</h4>
          </div>
          <div class='col-2 text-center'>
            <h4>Price</h4>
          </div>
          <div class='col-2 text-center'>
            <h4>Quantity</h4>
          </div>
          <div class='col-2 text-center'>
            <h4>Subtotal</h4>
          </div>
        </div>
    <!-- </div>
      
      <div class='container row mx-auto mt-3 justify-content-between bg-light'> -->
        <div class='row col-12 mt-3 font-roberto'>
        <% var subtotal = 0,fee=100 %>
        <% item.forEach((cart) => { %>
          <div class='col-4 col-xxl-2 col-xl-2 col-lg-2 col-md-3 col-sm-4 text-center'>
            <img src='<%= cart.productId.image %>' style="height: 100px; width: 100px; border-radius: 12px;" class='card-img-top'>
          </div>
          <div class='col-8 col-xxl-4 col-xl-4 col-lg-4 col-md-3 col-sm-8'>
            <h5><%= cart.productId.name %></h5>
          </div>
          <div class='col-4 col-xxl-2 col-xl-2 col-lg-2 col-md-2 col-sm-4 text-center'>
            <p>฿<%= cart.productId.price %></p>
          </div>
          <div class='col-1 col-xxl-2 col-xl-2 col-lg-2 col-md-2 col-sm-1'>
            <div class="form-group text-center">
              <!-- <input type="hidden" name='quantity' id ='<%=cart._id%>' value='<%= cart.quantity%>' min='1' max='<%= cart.productId.stock %>'> -->
              <p>x<%= cart.quantity %></p>
            </div>
          </div>
          <div class='col-0 col-xxl-2 col-xl-2 col-lg-2 col-md-2 col-sm-0 text-center text-transaction-hide'>
            <p>฿<%= cart.productId.price * cart.quantity %></p>
          </div>
          <hr class='mt-3'>
        <% subtotal = subtotal + (cart.quantity * cart.productId.price) %>
        <% }); %>
        <% total = subtotal + fee %>
        </div>
        </div>
        <div class='col-xxl-3 col-xl-3 col-lg-12 col-md-12 col-sm-12 col-12 shadow total-box py-3' style='height: fit-content; border-radius: 15px;'>
          <div class='container'>
            <form action='/user/history' method="post">  
              <div class='row mb-3 mt-3'>
                <div class='col-7'>
                  <h5>Subtotal<input type='hidden' name='subtotal' value='<%= subtotal %>'></h5>
                </div>
                <div class='col-5 text-end'>
                  <p>฿<%= subtotal %></p>
                </div>
              </div>
              <div class='row mb-3'>
                <div class='col-7'>
                  <h5>Shipping fee<input type='hidden' name='fee' value="<%= fee %>"></h5>
                </div>
                <div class='col-5 text-end'>
                  <p>฿<%= fee %></p>
                </div>
              </div>
              <hr class='mb-3'>
              <div class='row'>
                <div class='col-7'>
                  <h4>Total<input type='hidden' name='total' value='<%= total %>'></h4>
                </div>
                <div class='col-5 text-end'>
                  <h4>฿<%= total %></h4>
                </div>
              </div>
              <hr class='mt-1'>
              <div class='row d-flex justify-content-center'>
                <button class='btn btn-success' style='width: fit-content;'>Check out</button>
              </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<%- include('partials/footer.ejs') %>

